import{a as he,b as be,c as Me}from"./chunk-JRXPBAKO.js";import{a as L,b as W,c as J}from"./chunk-J2WM3DB5.js";import{A as Ce,C as y,E as _e,a as ee,b as te,c as ie,d as re,e as oe,f as ae,g as ne,h as me,i as le,j as se,k as de,l as ce,w as pe,x as ue,y as fe,z as ge}from"./chunk-EU6ZTCF4.js";import{p as Z}from"./chunk-BTI5GLDS.js";import{a as X,b as Y}from"./chunk-U6NW7K6H.js";import{a as H,b as $,d as D,e as q,i as z}from"./chunk-UENCSKWL.js";import{Bb as a,Cc as w,Db as p,Ec as R,Fa as m,Gc as f,Gd as K,Id as Q,Ja as g,Jc as N,Kc as k,Kd as S,Mc as j,Oc as A,Qa as v,Qc as B,Sc as V,Tc as G,Va as d,aa as h,ab as c,ec as O,ha as P,hc as I,ia as T,ib as o,jb as r,kb as l,lb as C,mb as _,ob as F,qb as b,rb as M,zc as x}from"./chunk-F7S2E7WL.js";var U=class{constructor(i,e,n,u){this.name=i;this.email=e;this.role=n;this.password=u}};function ye(t,i){if(t&1&&(o(0,"mat-option",13),a(1),r()),t&2){let e=i.$implicit,n=M();c("value",e.value),m(),p(" ",n.readableRoles[e.value]," ")}}var E=class t{constructor(i,e){this.userData=i;this.formBuilder=e}userService=h(w);toastr=h(x);editForm;readableRoles={0:"Admin",1:"Teacher",2:"Student"};roleOptions=[{value:0},{value:1},{value:2}];ngOnInit(){this.editForm=this.formBuilder.group({name:[this.userData.name,[f.required]],email:[this.userData.email,[f.required,f.email]],role:[this.userData.role,[f.required]],password:["",[f.required]],confirmPassword:["",[f.required]]},{validator:this.mustMatch("password","confirmPassword")})}mustMatch(i,e){return n=>{let u=n.controls[i],s=n.controls[e];s.errors&&s.errors.mustWatch||(u.value!==s.value?s.setErrors({mustMatch:!0}):s.setErrors(null))}}submit(){if(this.editForm.valid){let i=new U(this.editForm.value.name,this.editForm.value.email,this.editForm.value.role,this.editForm.value.password);this.userService.modifyUser(this.userData.email,i).subscribe({next:e=>this.toastr.success("User modified sucessfully","Modify user"),error:e=>this.toastr.error("Couldn't modify user","Modify User")})}}static \u0275fac=function(e){return new(e||t)(g(pe),g(V))};static \u0275cmp=v({type:t,selectors:[["app-user-edit"]],decls:34,vars:4,consts:[["mat-dialog-title",""],[1,"data-details-content"],[3,"ngSubmit","formGroup"],["appearance","fill"],["matInput","","placeholder","Example Name","formControlName","name"],["matInput","","placeholder","example@email.com","formControlName","email"],["formControlName","role"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","password","placeholder","password123","formControlName","password"],["matInput","","type","password","placeholder","password123","formControlName","confirmPassword"],[2,"display","flex","justify-content","flex-end","gap","1rem"],["mat-button","","type","button","mat-dialog-close",""],["mat-flat-button","","color","primary","type","submit","mat-dialog-close","",3,"disabled"],[3,"value"]],template:function(e,n){e&1&&(o(0,"h2",0),a(1),r(),o(2,"mat-dialog-content",1)(3,"form",2),b("ngSubmit",function(){return n.submit()}),o(4,"mat-form-field",3)(5,"mat-label"),a(6,"Name"),r(),l(7,"input",4),r(),l(8,"br"),o(9,"mat-form-field",3)(10,"mat-label"),a(11,"Email"),r(),l(12,"input",5),r(),l(13,"br"),o(14,"mat-form-field",3)(15,"mat-label"),a(16,"Role"),r(),o(17,"mat-select",6),d(18,ye,2,2,"mat-option",7),r()(),l(19,"br"),o(20,"mat-form-field",3)(21,"mat-label"),a(22,"Password"),r(),l(23,"input",8),r(),l(24,"br"),o(25,"mat-form-field",3)(26,"mat-label"),a(27,"Confirm Password"),r(),l(28,"input",9),r(),o(29,"div",10)(30,"button",11),a(31,"Cancel"),r(),o(32,"button",12),a(33,"Save"),r()()()()),e&2&&(m(),p("Edit Details of ",n.userData.name,""),m(2),c("formGroup",n.editForm),m(15),c("ngForOf",n.roleOptions),m(14),c("disabled",n.editForm.invalid))},dependencies:[y,fe,ge,Ce,S,Q,D,J,W,z,q,_e,I,O,L,G,j,R,N,k,A,B,Me,be,he],styles:[".data-details-content[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{padding:1rem;border-radius:12px;box-shadow:0 2px 10px #0000001a}.data-details-content[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin:.5rem 0;font-size:.95rem}mat-form-field[_ngcontent-%COMP%]{width:100%;min-width:25rem;padding-bottom:.4rem}mat-card-title[_ngcontent-%COMP%]{display:flex;justify-content:center;padding-top:1rem;padding-bottom:1rem}mat-card-content[_ngcontent-%COMP%]{display:flex;justify-content:center;padding-left:2rem;padding-right:2rem}"]})};function Ue(t,i){t&1&&(o(0,"th",13),a(1," Email "),r())}function Ee(t,i){if(t&1&&(o(0,"td",14),a(1),r()),t&2){let e=i.$implicit;m(),p(" ",e.email," ")}}function Pe(t,i){t&1&&(o(0,"th",13),a(1," Name "),r())}function Te(t,i){if(t&1&&(o(0,"td",14),a(1),r()),t&2){let e=i.$implicit;m(),p(" ",e.name," ")}}function Fe(t,i){t&1&&(o(0,"th",13),a(1," Role "),r())}function Oe(t,i){if(t&1&&(o(0,"td",14),a(1),r()),t&2){let e=i.$implicit;m(),p(" ",e.visibleRole," ")}}function Ie(t,i){t&1&&(o(0,"th",13),a(1," Creation Date "),r())}function Re(t,i){if(t&1&&(o(0,"td",14),a(1),r()),t&2){let e=i.$implicit;m(),p(" ",e.creationDate," ")}}function Ne(t,i){t&1&&l(0,"th",13)}function ke(t,i){if(t&1){let e=F();o(0,"td",14)(1,"button",15),b("click",function(){let u=P(e).$implicit,s=M();return T(s.deleteUser(u.email))}),o(2,"mat-icon",16),a(3,"delete"),r()(),o(4,"button",15),b("click",function(){let u=P(e).$implicit,s=M();return T(s.modifyUser(u))}),o(5,"mat-icon",17),a(6,"edit"),r()()()}}function je(t,i){t&1&&l(0,"tr",18)}function Ae(t,i){t&1&&l(0,"tr",19)}var ve=class t{constructor(i,e){this.userService=i;this.toastr=e;this.refreshData()}dialog=h(ue);userDetails=new ce;displayedColumns=["name","email","visibleRole","creationDate","actions"];refreshData(){this.userService.getAllUsers().subscribe({next:i=>{i.forEach(e=>{switch(e.role){case 0:e.visibleRole="Admin";break;case 2:e.visibleRole="Student";break;case 1:e.visibleRole="Teacher";break;default:break}}),this.userDetails.data=i},error:i=>this.toastr.error("Couldn't retrieve user data","User data")})}modifyUser(i){this.dialog.open(E,{data:i,width:"50rem"}).afterClosed().subscribe({next:n=>this.refreshData(),error:n=>console.log(n)})}deleteUser(i){this.userService.deleteUser(i).subscribe({next:e=>{this.refreshData(),this.toastr.success("User deleted succesfully","Delete User")},error:e=>this.toastr.error("Couldn't delete user","Delete User")})}static \u0275fac=function(e){return new(e||t)(g(w),g(x))};static \u0275cmp=v({type:t,selectors:[["app-user-page"]],decls:22,vars:3,consts:[[1,"table-card"],[1,"title"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","email"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","visibleRole"],["matColumnDef","creationDate"],["matColumnDef","actions"],["mat-header-row","","class","header-row",4,"matHeaderRowDef"],["mat-row","","class","data-row",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],[1,"delete-icon"],[1,"edit-icon"],["mat-header-row","",1,"header-row"],["mat-row","",1,"data-row"]],template:function(e,n){e&1&&(o(0,"mat-card",0)(1,"mat-card-title",1),a(2,"Users"),r(),o(3,"div",2)(4,"table",3),C(5,4),d(6,Ue,2,0,"th",5)(7,Ee,2,1,"td",6),_(),C(8,7),d(9,Pe,2,0,"th",5)(10,Te,2,1,"td",6),_(),C(11,8),d(12,Fe,2,0,"th",5)(13,Oe,2,1,"td",6),_(),C(14,9),d(15,Ie,2,0,"th",5)(16,Re,2,1,"td",6),_(),C(17,10),d(18,Ne,1,0,"th",5)(19,ke,7,0,"td",6),_(),d(20,je,1,0,"tr",11)(21,Ae,1,0,"tr",12),r()()()),e&2&&(m(4),c("dataSource",n.userDetails),m(16),c("matHeaderRowDef",n.displayedColumns),m(),c("matRowDefColumns",n.displayedColumns))},dependencies:[Y,X,S,K,Z,de,ee,ie,ne,re,te,me,oe,ae,le,se,D,H,$,y],styles:[".table-card[_ngcontent-%COMP%]{padding:20px;margin:20px;border-radius:12px;box-shadow:0 4px 10px #0000001a;background-color:var(--mat-card-background-color);width:95%}.title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:var(--mat-sys-primary);margin-bottom:10px}.edit-icon[_ngcontent-%COMP%]{color:var(--mat-sys-primary)}.delete-icon[_ngcontent-%COMP%]{color:var(--mat-sys-error)}.table-container[_ngcontent-%COMP%]{width:100%;min-width:50rem;display:flex;justify-content:center;overflow-x:auto}table[_ngcontent-%COMP%]{width:95%;border-collapse:collapse}th[_ngcontent-%COMP%]{background-color:var(--mat-sys-primary-container)!important;color:var(--mat-sys-on-primary-container);font-weight:700;text-transform:uppercase;padding:12px;text-align:left}.mat-column-actions[_ngcontent-%COMP%]{min-width:5rem}td[_ngcontent-%COMP%]{padding:12px;border-bottom:1px solid #e0e0e0;white-space:normal;overflow-wrap:break-word;word-wrap:break-word}.header-row[_ngcontent-%COMP%]{height:56px}.data-row[_ngcontent-%COMP%]:hover{background-color:var(--mat-sys-surface-container-highest);transition:background-color .3s ease}"]})};export{ve as UserPageComponent};
